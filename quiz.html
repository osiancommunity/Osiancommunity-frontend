<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSIAN - Quiz in Progress</title>
    <link rel="preconnect" href="https://osiancommunity-backend.vercel.app">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="stylesheet" href="style-quiz.css">
    <link rel="stylesheet" href="assets/boxicons-local.css">
</head>
<body oncontextmenu="return false;">

    <div id="warning-modal" class="modal-overlay active">
        <div class="modal-content">
            <i class='bx bxs-error-circle'></i>
            <h2>Quiz Instructions & Warnings</h2>
            <p>Please read the following rules carefully before you begin:</p>
            <ul>
                <li>This is a timed quiz. The timer will start once you click "Start".</li>
                <li><strong>Do NOT switch tabs or minimize the window.</strong></li>
                <li>Switching tabs will result in a warning. You get 3 warnings.</li>
                <li>On the 3rd violation, your quiz will be <strong>auto-submitted</strong>.</li>
                <li>Copying, pasting, or right-clicking is disabled.</li>
                <li>If you are found cheating, your result will be sent to the admin.</li>
            </ul>
            <p><strong>It is your responsibility to follow these rules.</strong></p>
            <button id="start-quiz-btn" class="btn-primary">I Understand, Start the Quiz</button>
        </div>
    </div>

    <div id="auto-submit-modal" class="modal-overlay">
        <div class="modal-content">
            <i class='bx bxs-shield-x'></i>
            <h2>Quiz Auto-Submitted</h2>
            <p>You exceeded the allowed number of tab switches.</p>
            <p>As per the rules, your quiz has been automatically submitted. A notification has been sent to the admin.</p>
            <a href="dashboard-user.html" class="btn-primary">Back to Dashboard</a>
        </div>
    </div>

    <div id="final-submit-modal" class="modal-overlay">
        <div class="modal-content">
            <i class='bx bxs-check-circle'></i>
            <h2>Quiz Submitted!</h2>
            <p>Your responses have been successfully recorded.</p>
            <p>For this quiz, the result will be available in 1-2 days. You can check your "My Quiz Progress" page.</p>
            <a href="dashboard-user.html" class="btn-primary">Back to Dashboard</a>
        </div>
    </div>

    <div id="confirm-submit-modal" class="modal-overlay">
        <div class="modal-content">
            <i class='bx bxs-help-circle'></i>
            <h2>Confirm Submission</h2>
            <p>Do you want to submit your answers now?</p>
            <div class="modal-actions">
                <button id="confirm-submit-btn" class="btn-primary">Submit</button>
                <button id="cancel-submit-btn" class="btn-secondary">Cancel</button>
            </div>
        </div>
    </div>


    <div id="quiz-container" class="quiz-container" style="display: none;">
        <header class="quiz-header">
            <div class="quiz-header-left">
                <button onclick="window.history.back()" class="btn-secondary back-btn">
                    <i class='bx bx-arrow-back'></i> Back
                </button>
                <h1 class="logo">OSIAN</h1>
            </div>
            <div class="quiz-info">
                <h3>Loading Quiz...</h3>
            </div>
            <div class="timer">
                <i class='bx bx-time'></i>
                <span id="time-left">00:00</span>
            </div>
        </header>

        <div id="cheating-warning" class="warning-banner" style="display: none;">
            <i class='bx bxs-error'></i>
            <strong>Warning!</strong> Violation <span id="violation-count">1</span> of 3. <span class="warning-text"></span>
        </div>

        <main class="quiz-main">
            <div class="question-header">
                <span id="question-number">Loading...</span>
                <h2>Loading question...</h2>
            </div>

            <div class="options-container">
                <!-- Options will be dynamically loaded here -->
            </div>

            <div class="written-answer-container" style="display: none;">
                <textarea id="written-answer" placeholder="Write your answer here..." rows="6"></textarea>
            </div>
            <div class="code-answer-container" style="display: none;">
                <div class="form-group">
                    <label id="code-language-label">Language: </label>
                </div>
                <textarea id="code-editor" placeholder="Write your code here..." rows="10" style="font-family: monospace;"></textarea>
                <div style="margin-top:10px; display:flex; gap:10px; align-items:center;">
                    <button id="run-code-btn" class="btn-primary" type="button">Run Code</button>
                    <span id="run-status" style="color: var(--text-light);"></span>
                </div>
                <div class="code-output" id="code-output" style="margin-top:10px; white-space: pre-wrap; background:#111; color:#0f0; padding:10px; border-radius:8px; display:none;"></div>
            </div>

            <div class="quiz-navigation">
                <button id="prev-btn" class="btn-secondary" style="display: none;">Previous</button>
                <button id="next-btn" class="btn-primary">Next</button>
                <button id="submit-btn" class="btn-submit" style="display: none;">Submit Quiz</button>
            </div>
        </main>
    </div>

    <div id="proctor-video-wrapper" style="display:none;">
        <video id="proctor-video" autoplay muted playsinline></video>
        <div id="proctor-status"></div>
    </div>

    <div id="proctor-loader" class="modal-overlay" style="display:none;">
        <div class="modal-content">
            <i class='bx bx-loader-circle'></i>
            <h2>Preparing Quiz</h2>
            <p>Initializing camera and security checks...</p>
        </div>
    </div>

    <script src="script-toast-helper.js"></script>
    <script src="script-quiz.js"></script>
</body>
</html>
